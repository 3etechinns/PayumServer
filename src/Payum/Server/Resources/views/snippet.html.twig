<script type="text/javascript">
    function psCheckout() {
        var xmlhttp = new XMLHttpRequest();
        var button = document.getElementById('ps-checkout-button');

        button.disabled = true;

        xmlhttp.onreadystatechange = function () {
            console.log(xmlhttp.readyState);

            if (xmlhttp.readyState == 4) {
                console.log(xmlhttp.responseText);

                if (xmlhttp.status == 200) {
                    var data = JSON.parse(xmlhttp.responseText);

                    console.log(data);

                    if (data.code == '302') {
                        window.location.href = data.body;
                    } else {
                        document.getElementById('ps-checkout-content').innerHTML = data.body;
                    }
                } else {
                    alert('Some error');
                }

                /*switch (xmlhttp.status) {
                 case 200:
                 console.log('200');
                 document.getElementById('ps-checkout-content').innerHTML = xmlhttp.responseText;
                 break;
                 default:
                 console.log('default');
                 break;
                 }*/

                button.disabled = false;
            }
        };
        xmlhttp.open('GET', '{{ captureUrl }}', true);
        xmlhttp.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
        xmlhttp.send();
    }
</script>